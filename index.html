<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        send_request('2017-06-01');
        $('.send_data').click(function () {
                gcw_handlerFDtbXg6kP.reload();
                send_request($('#month').val() + '-01');
            }
        )
        $('.change_currecy_rub').click(function () {
            var usd_curr = 1;
            if ($('#label').val() == "usd") {
                usd_curr = $('#gcw_valFDtbXg6kP1').val();
            } else {
                usd_curr = 1 / $('#gcw_valFDtbXg6kP1').val();
            }
            $('#table #salary').each(function () {
                    $(this).html($(this).html() / usd_curr);
                }
            )
        })
    });
    function send_request(data) {
        $("tr").empty();
        $.ajax({
            type: 'GET',
            url: 'index.php',
            data: {'month': data},
            success: function (result) {
                if (result != "Error-Not Found-404-Fatality") {
                    console.log(result);
                    var html = '<tr></tr><th>Имя</th><th>Фамилия</th><th>Должность</th><th>ЗП</th><th>Бонус</th><th>Фото</th><th>Дата</th></tr>';
                    $.each($.parseJSON(result), function (index, element) {
                        html += '<tr><td>' + element.Worker_Name + '</td><td>' + element.Worker_LastName + '</td><td>' + element.Worker_Prof + '</td><td  id="salary">' + element.Salary + '</td><td>' + element.Bonus + '</td><td>' + element.Avatar + '</td><td>' + element.Date_s + '</td></tr>';
                    });
                } else html = "Error-Not Found-404-Fatality";
                $('#table > tbody').append(html);
            }
        });
    }

</script>


<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
    <title>Test WineStyle</title>
    <link rel="stylesheet" href="css/style.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>
<body>

<h1>Вывод зарплат сотрудников</h1>

<table class="table-bordered" id="table">
    <tbody>
    </tbody>
</table>

<p>
    <input type="month" name="month" id="month">
    <input type="submit" value="Показать за месяц" class="send_data">
</p>
<p>
    <input type="submit" value="Изменить Валюту" class="change_currecy_rub">
    <select name="currency" id="label">
        <option value="rub">rub</option>
        <option value="usd">usd</option>
    </select>
</p>


<form action="#openModal">
    <input type="submit" class="button_active" value="Добавить нового сотрудника">
</form>

<div id="openModal" class="modalDialog">
    <div>
        <a href="#close" title="Закрыть" class="close">X</a>
        <h2>Модальное окно</h2>

    </div>
</div>

<p><input name="ch_currency" type="radio" value="Rub" checked>Rub</p>
<p><input name="ch_currency" type="radio" value="Usd">Usd</p>

<div id='gcw_mainFDtbXg6kP' class='gcw_mainFDtbXg6kP'></div>

<script>function reloadFDtbXg6kP() {
    var sc = document.getElementById('scFDtbXg6kP');
    if (sc) sc.parentNode.removeChild(sc);
    sc = document.createElement('script');
    sc.type = 'text/javascript';
    sc.charset = 'UTF-8';
    sc.async = true;
    sc.id = 'scFDtbXg6kP';
    sc.src = 'https://freecurrencyrates.com/ru/widget-horizontal?iso=USDRUB&df=2&p=FDtbXg6kP&v=i&source=cbr&width=220&width_title=110&firstrowvalue=1&thm=aaaaaa,C9C9C9,BBBBBB,dddddd,444444,cccccc,f8f8f8,3383BB,000000&title=%D0%9A%D0%BE%D0%BD%D0%B2%D0%B5%D1%80%D1%82%D0%B5%D1%80%20%D0%B2%D0%B0%D0%BB%D1%8E%D1%82&tzo=-180';
    var div = document.getElementById('gcw_mainFDtbXg6kP');
    div.parentNode.insertBefore(sc, div);
}
reloadFDtbXg6kP(); </script>


</body>
</html>